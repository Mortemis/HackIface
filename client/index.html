<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

    <title>Main Server Interface</title>
    <link href="css/hacker.css" rel="stylesheet">

    <style>
        .tall-row {
            margin-top: 40px;
        }

        .modal {
            position: relative;
            top: auto;
            right: auto;
            left: auto;
            bottom: auto;
            z-index: 1;
            display: block;
        }
    </style>
</head>

<body>

    <!-- <a href="https://github.com/brobin/hacker-bootstrap"><img style="position: absolute; top: 0; left: 0; border: 0;z-index:1001;" src="img/fork.png" alt="Fork me on GitHub"></a> -->

    <!-- Navigation menu -->
    <nav class="navbar navbar-default navbar-static-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar"
                    aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Home</a>
            </div>
            
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav navbar-right">
                    <!-- 
                    <li class="dropdown">
                        
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                            aria-expanded="false">CLICK ME!!!<span class="caret"></span> </a>
                        <ul class="dropdown-menu" role="menu">
                            <li><a href="#">Ooh a link</a></li>
                            <li><a href="#">Two links?! Oh boy</a></li>
                            <li><a href="#">Now you're being ridiculous</a></li>
                            <li class="divider"></li>
                            <li class="dropdown-header">Much Wow</li>
                            <li><a href="#">So link</a></li>
                            <li><a href="#">Many internet</a></li>
                        </ul>
                    
                    </li>
                    -->
                    <li>
                        <a href="/example.html">Interface example</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>


    <div class="container">
        <!-- Typography -->
        <div class="row tall-row">
            <div class="col-lg-12">
                <h1>Main server monitor</h1>
                <hr>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">
                <h2 id="processorLoadText">Processor load</h2>
                <div class="progress progress-striped active">
                    <div id="loadBar" class="progress-bar progress-bar-info"></div>
                </div>
                <script>
                    setInterval(updateLoad, 1000)
                    updateLoad();
                    function updateLoad() {
                        $.get('/api/sysinfo/coreload', '', gotLoad);
                    }
                    function gotLoad(data) {
                        document.getElementById("loadBar").style.width = `${data}%`;
                        document.getElementById("processorLoadText").innerText = `Processor load | ${data}%`;
                    }
                </script>
                <h2>Memory</h2>
                <div class="progress progress-striped active">
                    <div class="progress-bar progress-bar-info" style="width: 0%"></div>
                </div>
                <h2>Disk 1</h2>
                <div class="progress progress-striped active">
                    <div class="progress-bar progress-bar-info" style="width: 0%"></div>
                </div>
                <h2>Disk 2</h2>
                <div class="progress progress-striped active">
                    <div class="progress-bar progress-bar-info" style="width: 0%"></div>
                </div>
            </div>
            <div class="col-md-4">
                <h2>Core temperature</h2>
                <hr>
                <h1 id="temperatureText"></h1>
                <script>
                    updateTemp();
                    setInterval(updateTemp, 1000)
                    function updateTemp() {
                        $.get('/api/sysinfo/temp', '', gotTemp);
                    }
                    function gotTemp(data) {
                        document.getElementById("temperatureText").innerText = `${data}Â°C`;
                    }

                </script>
            </div>
            <div class="col-md-4">
                <h2>Uptime</h2>
                <hr>
                <h1 id="uptimeText"></h1>
                <script>
                    updateUptime();
                    setInterval(updateUptime, 1000)
                    function updateUptime() {
                        $.get('/api/sysinfo/uptime', '', gotUptime);
                    }
                    function gotUptime(data) {
                        document.getElementById("uptimeText").innerText = secondsToString(data);
                    }
                    function secondsToString(data) {
                        var seconds;
                        var minutes;
                        var hours;
                        var days;
                        seconds = data%60;
                        minutes = Math.floor(data/60)%60;
                        hours = Math.floor((data/60)/60)%24;
                        days = Math.floor(((data/60)/60)/24)
                        var string = `${days} days\n ${hours} hours\n ${minutes} minutes\n ${seconds} seconds`;
                        return string;
                    }

                </script>
            </div>
        </div>


        <!-- Github stars script -->
        <script>
            $(document).ready(function () {
                $.getJSON("https://api.github.com/repos/brobin/hacker-bootstrap", function (data) {
                    var stars = data['stargazers_count'];
                    $("#stars").text(stars + " stars");
                });
            });
        </script>

</html>